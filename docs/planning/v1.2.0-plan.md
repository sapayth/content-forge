# v1.2.0 - The AI & Smart Update - Implementation Plan

**Release Date Target:** Month 2  
**Status:** Planning Phase  
**Focus:** AI Integration & User-Selected Content Types

---

## Overview

v1.2.0 introduces AI-powered content generation, user-selectable content types, and expanded post status options. This release enhances the plugin's ability to generate more realistic and contextually appropriate content based on user preferences.

---

## Features Breakdown

### 1. AI Content Generation (Beta)

#### 1.1 Overview
- Integration with OpenAI API (user provides their own API key)
- Generate realistic titles and body content based on user prompts
- Support for both Block Editor and Classic Editor
- Beta status indicates this is an optional, opt-in feature

#### 1.2 Technical Requirements

**Backend (PHP):**
- New class: `ContentForge\Generator\AI_Content_Generator`
  - Handles OpenAI API communication
  - Manages API key storage (encrypted in WordPress options)
  - Converts AI responses to appropriate editor format
  - Error handling for API failures/rate limits
  - Fallback to regular generation if AI fails

- New class: `ContentForge\Settings\AI_Settings`
  - Manages OpenAI API key storage
  - Settings page/UI for API configuration
  - Validation of API keys
  - Test connection functionality

- Extend `ContentForge\Generator\Post`:
  - Add `use_ai_generation` parameter
  - Add `ai_prompt` parameter (optional, auto-generate if not provided)
  - Add `content_type` parameter (user-selected: blog, e-commerce, portfolio, business, etc.)
  - Integrate AI generator when enabled
  - Use content type to enhance prompts and generation
  - Maintain backward compatibility (default: false)

**Frontend (React):**
- New component: `AISettings.jsx` (Settings page)
  - API key input field (password type)
  - Test connection button
  - Status indicator (connected/disconnected)
  - Usage statistics (optional)

- Update `pages-posts.jsx`:
  - Add toggle for "Use AI Generation" (Beta badge)
  - Add content type selector dropdown (when AI enabled or for regular generation)
  - Add optional prompt input field (when AI enabled)
  - Show AI generation status during generation
  - Handle AI-specific errors gracefully

**REST API:**
- New endpoint: `POST /cforge/v1/ai/test-connection`
  - Validates API key
  - Returns connection status

- New endpoint: `POST /cforge/v1/ai/generate`
  - Generates content via OpenAI
  - Parameters: prompt, content_type (user-selected niche), generation_type (title/body), editor_type
  - Returns generated content

- Update `POST /cforge/v1/posts/bulk`:
  - Add optional `use_ai` parameter
  - Add optional `ai_prompt` parameter
  - Add optional `content_type` parameter (user-selected content category)
  - Pass through to Post generator

**Security Considerations:**
- API keys stored encrypted using WordPress `update_option()` with encryption
- Or use WordPress Transients API with encryption
- Never expose API key in frontend
- Validate API key format before storing
- Rate limiting considerations (OpenAI has rate limits)
- Cost awareness (show estimated token usage)

**Editor Support:**
- **Block Editor:** Generate content as Paragraph/Heading blocks
  - Use WordPress block grammar format
  - Structure: `<!-- wp:paragraph -->...<!-- /wp:paragraph -->`
  - Support headings, lists, paragraphs
  
- **Classic Editor:** Generate content as HTML
  - Use standard HTML tags (`<p>`, `<h2>`, `<ul>`, etc.)
  - Maintain existing formatting logic

**Dependencies:**
- WordPress HTTP API for API calls
- Consider adding `guzzlehttp/guzzle` via Composer (optional, for better error handling)
- Or use WordPress `wp_remote_post()` (built-in, preferred)

#### 1.3 User Experience Flow

1. **Initial Setup:**
   - User navigates to Settings → AI Configuration
   - Enters OpenAI API key
   - Tests connection
   - Saves settings

2. **Content Generation:**
   - User goes to Pages/Posts → Add New
   - Selects content type from dropdown (e.g., Blog, E-commerce, Portfolio, Business, etc.)
   - Optionally enables "Use AI Generation (Beta)" toggle
   - If AI enabled, optional prompt field appears
   - User can provide custom prompt or use auto-generated (enhanced by content type)
   - Generate content (shows loading state)
   - Content appears formatted for active editor, tailored to selected content type

3. **Error Handling:**
   - API key invalid → Show error, suggest checking key
   - Rate limit exceeded → Show warning, suggest waiting
   - Network error → Fallback to regular generation with notice
   - Invalid prompt → Show validation error

#### 1.4 Implementation Files

**New Files:**
- `includes/Generator/AI_Content_Generator.php`
- `includes/Settings/AI_Settings.php`
- `includes/Api/AI.php` (REST API endpoints)
- `src/js/components/AISettings.jsx`
- `src/js/components/AIGenerationToggle.jsx`

**Modified Files:**
- `includes/Generator/Post.php` (add AI integration)
- `includes/Api/Post.php` (add AI parameters)
- `includes/Admin.php` (add Settings submenu)
- `src/js/pages-posts.jsx` (add AI UI)
- `includes/Loader.php` (register new classes)

---

### 2. User-Selected Content Types

#### 2.1 Overview
- Allow users to select the type of content they want to generate
- Improve relevance of generated content based on user selection
- Enhance both AI and regular generation with content-type-specific data
- Provide better context for AI prompts

#### 2.2 Content Type Categories

**Available Content Types:**
- **General/Blog** - General blog posts, articles, news
- **E-commerce** - Product descriptions, reviews, shopping content
- **Portfolio** - Project showcases, case studies, creative work
- **Business/Corporate** - Business articles, corporate content, professional
- **Education** - Educational content, tutorials, courses
- **Health/Medical** - Health articles, medical information, wellness
- **Technology** - Tech articles, reviews, tutorials
- **Food/Recipe** - Recipe content, food articles, cooking
- **Travel** - Travel guides, destination content, trip planning
- **Fashion** - Fashion articles, style guides, trends
- **Other** - Generic content (default fallback)

#### 2.3 Technical Implementation

**Backend (PHP):**
- New class: `ContentForge\Content\Content_Type_Data`
  - Store content-type-specific word lists
  - Store content-type-specific content templates
  - Store content-type-specific title patterns
  - Provide data for both AI and regular generation

- Extend `ContentForge\Generator\Post`:
  - Accept `content_type` parameter
  - Use content-type-specific data when generating titles
  - Use content-type-specific data when generating content
  - Enhance AI prompts with content type context
  - Fallback to 'general' if invalid type provided

- Extend `ContentForge\Generator\AI_Content_Generator`:
  - Use content type to enhance prompts
  - Provide context-specific examples in prompts
  - Generate more relevant content based on type

**Frontend (React):**
- Add content type selector dropdown in `pages-posts.jsx`
  - Visible for both AI and regular generation
  - Default to 'general' if not selected
  - Show description/tooltip for each type
  - Update UI based on selection (optional visual feedback)

**Data Structure:**
```php
$content_types = [
    'general' => [
        'label' => 'General/Blog',
        'keywords' => ['article', 'blog', 'news', 'post'],
        'templates' => [...],
    ],
    'e-commerce' => [
        'label' => 'E-commerce',
        'keywords' => ['product', 'review', 'shopping', 'buy'],
        'templates' => [...],
    ],
    // ... other types
];
```

#### 2.4 Implementation Files

**New Files:**
- `includes/Content/Content_Type_Data.php`
- `includes/Content/data/` (directory with content-type-specific data files)

**Modified Files:**
- `includes/Generator/Post.php` (use content type data)
- `includes/Generator/AI_Content_Generator.php` (enhance prompts with content type)
- `includes/Api/Post.php` (accept content_type parameter)
- `src/js/pages-posts.jsx` (add content type selector)

---

### 3. Post Status Variations

#### 3.1 Overview
- Support for Draft, Pending, Private, and Future (Scheduled) post statuses
- Currently only supports 'publish' status
- Add scheduling functionality for future posts

#### 3.2 Technical Implementation

**Backend (PHP):**
- Update `ContentForge\Generator\Post::generate()`:
  - Support `post_status` parameter (already partially supported)
  - Support `post_date` parameter for scheduling
  - Validate status values
  - Handle 'future' status with `post_date_gmt`

- Update `ContentForge\Api\Post::handle_bulk_create()`:
  - Add validation for 'future' status
  - Add `post_date` parameter handling
  - Validate date format and future dates

**Frontend (React):**
- Update `pages-posts.jsx`:
  - Add 'future' to allowed post statuses
  - Add date/time picker when 'future' is selected
  - Validate future date (must be in future)
  - Show scheduling preview

**Status Support:**
- `publish` - Published immediately ✅ (already supported)
- `draft` - Draft status ✅ (already supported in API, needs UI update)
- `pending` - Pending review ✅ (already supported in API, needs UI update)
- `private` - Private posts ✅ (already supported in API, needs UI update)
- `future` - Scheduled posts ⚠️ (needs implementation)

**Date Handling:**
- Use WordPress date format
- Convert to GMT for `post_date_gmt`
- Validate date is in future
- Handle timezone considerations

#### 3.3 Implementation Files

**Modified Files:**
- `includes/Generator/Post.php` (add date handling)
- `includes/Api/Post.php` (add date validation)
- `src/js/pages-posts.jsx` (add date picker, update status options)
- `includes/functions/general.php` (add date helper functions, if needed)

---

## Database Schema Changes

**No schema changes required** - All features use existing WordPress post meta and options API.

**New Options:**
- `cforge_ai_api_key` (encrypted)
- `cforge_ai_enabled` (boolean)

---

## Testing Requirements

### 1. AI Content Generation
- [ ] Test with valid API key
- [ ] Test with invalid API key
- [ ] Test with rate-limited API key
- [ ] Test network failure scenarios
- [ ] Test Block Editor content format
- [ ] Test Classic Editor content format
- [ ] Test with custom prompts
- [ ] Test with auto-generated prompts
- [ ] Test fallback to regular generation
- [ ] Test API key encryption/decryption

### 2. User-Selected Content Types
- [ ] Test all content type options
- [ ] Test content type with regular generation
- [ ] Test content type with AI generation
- [ ] Test content type data loading
- [ ] Test fallback to 'general' for invalid types
- [ ] Test content relevance per type

### 3. Post Status Variations
- [ ] Test draft status
- [ ] Test pending status
- [ ] Test private status
- [ ] Test future/scheduled status
- [ ] Test date validation (past dates rejected)
- [ ] Test timezone handling
- [ ] Test bulk generation with different statuses

### 4. Integration Testing
- [ ] Test AI + Content Type together
- [ ] Test AI + Post Status together
- [ ] Test Content Type + Post Status together
- [ ] Test all features with Block Editor
- [ ] Test all features with Classic Editor
- [ ] Test backward compatibility (existing features still work)

---

## UI/UX Considerations

### Settings Page
- New submenu: "Content Forge → Settings"
- Tabbed interface: "General", "AI Configuration"
- AI Configuration tab:
  - API key input (password field)
  - Test connection button
  - Connection status indicator
  - Usage information (optional)
  - Beta disclaimer

### Pages/Posts Generation UI
- Add content type selector dropdown (always visible)
- Add "Use AI Generation" toggle (with Beta badge)
- Show prompt input when AI enabled
- Add date picker for scheduled posts
- Update status dropdown to include all statuses
- Show content type description/tooltip

---

## Security Considerations

1. **API Key Storage:**
   - Encrypt API keys at rest
   - Never expose in frontend
   - Use WordPress nonces for all API operations
   - Capability checks for settings access

2. **Input Validation:**
   - Sanitize all user inputs
   - Validate API responses
   - Rate limit API calls (prevent abuse)
   - Validate dates and statuses

3. **Error Handling:**
   - Don't expose API keys in error messages
   - Log errors securely
   - Graceful degradation (fallback to regular generation)

---

## Performance Considerations

1. **AI API Calls:**
   - Cache API responses where possible
   - Implement request queuing for bulk operations
   - Show progress indicators for long operations
   - Consider async processing for large batches

2. **Content Type Data:**
   - Lazy load content type data files
   - Cache loaded data in memory during request
   - Don't block generation if data loading fails

3. **Database:**
   - No new tables required
   - Use WordPress options API efficiently
   - Clean up old transients

---

## Documentation Requirements

1. **User Documentation:**
   - How to obtain OpenAI API key
   - How to configure AI settings
   - How to use AI generation
   - How to select content types
   - How scheduling works
   - Content type descriptions

2. **Developer Documentation:**
   - AI generator class documentation
   - Content type data structure
   - How to add custom content types
   - Hooks and filters for extension
   - Customization examples

3. **Changelog:**
   - Document all new features
   - Document breaking changes (if any)
   - Document deprecations (if any)

---

## Migration & Backward Compatibility

- **No breaking changes** - All new features are opt-in
- Existing generation methods continue to work
- AI generation is optional (default: disabled)
- Content type selection is optional (default: 'general')
- Post status variations extend existing functionality

---

## Release Checklist

### Pre-Release
- [ ] All features implemented
- [ ] All tests passing
- [ ] Code review completed
- [ ] Documentation updated
- [ ] Changelog updated
- [ ] Version numbers updated
- [ ] Translation strings added

### Release
- [ ] Tag release in Git
- [ ] Update readme.txt
- [ ] Update plugin header version
- [ ] Test installation on fresh WordPress
- [ ] Test upgrade from v1.1.0

### Post-Release
- [ ] Monitor error logs
- [ ] Gather user feedback
- [ ] Plan hotfixes if needed

---

## Future Enhancements (Out of Scope for v1.2.0)

- Multiple AI provider support (Anthropic, Google, etc.)
- AI prompt templates library
- Custom content type creation UI
- Advanced scheduling (recurring posts)
- AI content quality scoring
- Batch AI generation with progress tracking
- Content type presets/saved configurations

---

## Estimated Development Time

- **AI Content Generation:** 3-4 days
- **User-Selected Content Types:** 2-3 days
- **Post Status Variations:** 1-2 days
- **Testing & QA:** 2-3 days
- **Documentation:** 1 day

**Total:** ~9-13 days (1.8-2.5 weeks)

---

## Dependencies & Prerequisites

- WordPress 5.6+
- PHP 7.4+
- OpenAI API account (user-provided)
- Composer (for potential HTTP client library)
- Node.js/npm (for frontend build)

---

## Risk Assessment

**High Risk:**
- OpenAI API changes/outages
- API cost overruns (user's responsibility, but need clear warnings)

**Medium Risk:**
- Content type data quality/completeness
- Performance with large batches

**Low Risk:**
- Post status variations (straightforward implementation)
- Backward compatibility (all features opt-in)

---

## Success Metrics

- AI generation successfully creates content in correct editor format
- Content types improve content relevance (subjective, user feedback)
- All post statuses work correctly
- No breaking changes for existing users
- Positive user feedback on AI feature and content type selection

---

## Notes

- AI feature is marked as Beta to set expectations
- Consider adding usage limits or warnings about API costs
- Monitor OpenAI API usage patterns
- Consider adding analytics for feature adoption
